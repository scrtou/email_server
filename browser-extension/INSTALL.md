# 安装和使用指南

## 前置条件

1. **Email Server 后端运行中**
   - 确保 Email Server 后端服务正在运行
   - 默认地址：`http://localhost:8080` 或 `http://localhost:5555`
   - 可以通过访问 `/api/v1/health` 端点验证服务状态

2. **浏览器支持**
   - Chrome 88+ 或其他基于 Chromium 的浏览器
   - Firefox 109+（需要适配 Manifest V2）
   - Edge 88+

## 安装步骤

### 方法一：开发者模式安装（推荐用于测试）

1. **下载插件文件**
   ```bash
   # 如果您有完整的项目
   cd email_server/browser-extension
   
   # 或者单独下载 browser-extension 文件夹
   ```

2. **打开浏览器扩展管理页面**
   - Chrome: 地址栏输入 `chrome://extensions/`
   - Edge: 地址栏输入 `edge://extensions/`

3. **启用开发者模式**
   - 在扩展管理页面右上角，开启"开发者模式"开关

4. **加载插件**
   - 点击"加载已解压的扩展程序"按钮
   - 选择 `browser-extension` 文件夹
   - 插件将出现在扩展列表中

5. **验证安装**
   - 浏览器工具栏应该出现插件图标
   - 点击图标应该能打开弹窗界面

### 方法二：打包安装

1. **创建插件包**
   ```bash
   cd browser-extension
   zip -r email-server-extension.zip . -x "*.md" "icons/README.md"
   ```

2. **安装插件包**
   - 在扩展管理页面，拖拽 `.zip` 文件到页面中
   - 或点击"加载已解压的扩展程序"，选择解压后的文件夹

## 初始配置

### 1. 配置服务器连接

1. **打开设置页面**
   - 点击插件图标
   - 点击"设置"按钮
   - 或右键插件图标 → "选项"

2. **配置服务器地址**
   - 输入 Email Server 后端地址
   - 例如：`http://localhost:8080` 或 `http://localhost:5555`
   - 点击"测试连接"验证连接

3. **保存设置**
   - 点击"保存设置"按钮
   - 看到"设置已保存"提示即可

### 2. 登录账户

1. **在弹窗中登录**
   - 点击插件图标打开弹窗
   - 在"登录"标签页输入用户名和密码
   - 点击"登录"按钮

2. **验证登录状态**
   - 成功登录后，状态显示为"已连接到服务器"
   - 可以切换到"账号列表"查看现有数据

## 使用方法

### 自动检测模式

1. **访问登录页面**
   - 打开任何网站的登录或注册页面
   - 插件会自动检测表单

2. **填写表单**
   - 正常填写用户名、密码、邮箱等信息
   - 提交表单

3. **保存提示**
   - 表单提交后，页面右上角会显示保存提示
   - 点击"保存到服务器"确认保存
   - 或点击"忽略"跳过

### 手动添加模式

1. **打开插件弹窗**
   - 点击浏览器工具栏中的插件图标

2. **切换到手动添加**
   - 点击"手动添加"标签页

3. **填写账号信息**
   - 平台名称（会自动填充当前网站域名）
   - 邮箱地址
   - 用户名
   - 密码
   - 备注（可选）

4. **保存账号**
   - 点击"添加账号"按钮
   - 看到成功提示即可

### 查看账号列表

1. **打开账号列表**
   - 在插件弹窗中点击"账号列表"标签页

2. **查看保存的账号**
   - 显示所有已保存的平台注册信息
   - 包括平台名称、邮箱、用户名、创建时间

3. **刷新数据**
   - 点击"刷新列表"获取最新数据

## 高级设置

### 自动检测设置

- **自动检测登录表单**: 启用/禁用表单自动检测
- **显示保存通知**: 控制是否显示保存提示
- **自动保存账号信息**: 检测到信息时自动保存（谨慎使用）

### 排除网站

- 在"排除网站"字段中输入不希望检测的域名
- 多个域名用逗号分隔
- 例如：`example.com, test.org`

## 故障排除

### 常见问题

1. **无法连接到服务器**
   - 检查 Email Server 后端是否运行
   - 验证服务器地址是否正确
   - 确认网络连接正常

2. **登录失败**
   - 确认用户名和密码正确
   - 检查 Email Server 中是否存在该用户
   - 查看浏览器控制台是否有错误信息

3. **表单检测不工作**
   - 确认已启用"自动检测登录表单"
   - 检查网站是否在排除列表中
   - 某些复杂的单页应用可能需要手动添加

4. **保存失败**
   - 确认已登录到 Email Server
   - 检查网络连接
   - 验证表单数据是否完整

### 调试方法

1. **查看控制台日志**
   - 按 F12 打开开发者工具
   - 查看 Console 标签页的错误信息

2. **检查插件日志**
   - 在扩展管理页面找到插件
   - 点击"详细信息"
   - 点击"检查视图"查看后台脚本日志

3. **测试 API 连接**
   - 在设置页面使用"测试连接"功能
   - 直接访问 `http://your-server/api/v1/health`

## 安全注意事项

1. **密码安全**
   - 插件使用浏览器安全存储 API
   - 密码在传输时会加密
   - 建议使用 HTTPS 连接

2. **权限管理**
   - 插件只请求必要的权限
   - 不会访问无关的网页内容
   - 所有数据存储在本地或您的 Email Server

3. **网络安全**
   - 生产环境建议使用 HTTPS
   - 定期更新插件版本
   - 注意保护 Email Server 的访问权限

## 更新插件

### 开发者模式更新

1. 下载最新版本的插件文件
2. 在扩展管理页面点击插件的"刷新"按钮
3. 或重新加载插件文件夹

### 商店版本更新

- 浏览器会自动检查和安装更新
- 也可以在扩展管理页面手动检查更新

## 卸载插件

1. 打开浏览器扩展管理页面
2. 找到"Email Server 账号管理器"
3. 点击"移除"按钮
4. 确认卸载

**注意**: 卸载插件不会删除 Email Server 中已保存的数据。
